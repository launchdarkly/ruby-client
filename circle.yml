machine:
  environment:
    RUBIES: "ruby-2.4.1;ruby-2.2.2;jruby-9.0.0.0"

dependencies:
  cache_directories:
    - '../.rvm/rubies'

  override:
    - >
      rubiesArray=(${RUBIES//;/ });
      for i in "${rubiesArray[@]}";
      do
        rvm install $i;
        rvm use $i;
        gem install jruby-openssl; # required by bundler, no effect on Ruby MRI
        gem install bundler;
        bundle install;
      done

test:
  override:
    - >
      rubiesArray=(${RUBIES//;/ });
      for i in "${rubiesArray[@]}";
      do
        rvm use $i;
        bundle exec rspec spec;
      done
